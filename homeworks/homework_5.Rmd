---
title: "homework_5.rmd"
author: "KD"
date: "2023-09-28"
output: html_document
---
Make a function that reads in data and does some sort of manipulation of it. Undergrads, use the surveys data set. Graduates, use your own data. Any manipulation is fine: selection, filtering, value removal.

```{r}
# Answer here

 clean <- function(data, column) { 
   new <- data %>% 
    na.omit 
 return(new)
  }

clean(play_data, output)

```


Add a test to this function. How will you know if it worked, and alert a user if it did not?
```{r}
# Answer here

clean <- function(data, column, new_column) {
  column <- as.character(column)
  new_column <- as.character(new_column)
  
  new <- data %>% 
  mutate(new={{column}}/2) %>% 
  rename(!!new_column := !!column) %>% 
  return(new)
}

added <- clean(play_data,"output","new_column")
print(added)

#I wasn't able to get his one to ru however, I would do a "if, else" function to tell the user a message if there are nay empty cells or NA's within the data set. 

#AMW: Right, so this one won't run because column was just transformed to a character, I think? 
```


Make a function that makes a plot. This can be any type of plot that we covered. Violin, box, scatter. Include the ability to save the plot to a file in the function.

```{r}
# Answer here
create_bar_plot <- function(data, x_col, y_col, xlab = "Sample_number ", ylab = "Eggs layed", title = "Bar Plot") {
  
  timestamp <- format(Sys.time(), "%Y%m%d%H%M%S")
  filename <- paste0("bar_plot_", timestamp, ".png")
#AMW: I love the idea of a timestamp on this!  
plot <- ggplot(data, aes(x = data[[x_col]], y = data[[y_col]])) +
geom_col(stat = "identity") +
labs(x = xlab, y = ylab) +
ggtitle(title)+
theme(axis.text.x = element_text(angle = 45, hjust = 1)) 
 
ggsave(filename, plot, device = "png") 
   
cat("Bar Plot saved as", filename, ", ", path = "/cloud/project/")
}

create_bar_plot(play_data, "sample", "output")

```


For saving to a file, users of your function may want the ability to choose their file name. Make the filename an argument so that users can do so.

```{r}
# Answer here

create_bar_plot_name<- function(data, x_col, y_col, filename = "bar_plot.png", xlab = "Sample_number ", ylab = "Eggs layed", title = "Bar Plot") {
  
plot <- ggplot(data, aes(x = data[[x_col]], y = data[[y_col]])) +
geom_col(stat = "identity") +
labs(x = xlab, y = ylab) +
ggtitle(title)+
theme(axis.text.x = element_text(angle = 45, hjust = 1)) 
 
ggsave(filename, plot, device = "png") 
   
cat("Bar Plot saved as", filename, "\n", path = "/cloud/project/")
}

#default
create_bar_plot_name(play_data, "sample", "output")

#specified
create_bar_plot_name(play_data, "sample", "output", "custom.png")


```





