---
title: "project_2"
author: "KD"
date: "2023-10-12"
output: html_document
---
# "Part 1" 

Load in your data. Which variable will you be using as a predictor, and which as a response? (5 pts)
```{r}
# read in data here
setwd("/cloud/project")
bocas <- read.csv("projects/Summer_2023_Bocas_data.csv", na = c("Not Recorded", "NA","")) %>% 
  filter(!is.na(tag)) 
bocas

turtles_sampled<- bocas %>%
  count(tag)

turtles_sampled

```

```{r}
# Answer which column is predictor and which is response

#Predictor is the curved carapace length and the response is either VTG, E2, or T
#I predict that the size of the turtle may effect it's concentration of sex steroids and other reproductive biomarkers.

```

Plot the two against each other with a scatter plot. Do the data appear to be related linearly? (5 pts)
```{r}
# Plot here

ggplot(bocas, aes(x = curved_carapace_length, y =  t)) + 
  geom_point()

ggplot(bocas, aes(x = t, y = curved_carapace_length)) + 
  geom_point()

ggplot(bocas, aes(x = t, y = output)) + 
  geom_point()

ggplot(bocas, aes(x = output, y = t)) + 
  geom_point()
```

```{}
Answer here:
So far with my real and fake data, the relationship does not apear to be linear

#With my fake data, so far, there is no relatinship and it is not linear at all. I should hopefully get some actual working data this week and the next. Fingers crossed!!! 
I plan to redo this project as soon as I have any data
```

Fit the linear model. View the summary. (5 pts)
```{r}
# Code here
model_fit <- lm(output ~ t, data = bocas)
summary(model_fit)
```
Does the summary make sense when you compare it to the plot you made? Does our model have good predictive power? Evaluate the residual standard error, intercept, and R-Squared in particular. Would you say your predictor predicts the response? (10 pts)

```{}
# Answer here
-I feel like my summary makes alot of sense. There is so relationship which has been shown through the linear model analysis. The plot look entirely random to me. 
- Since there is no clear relationship, there is no predictive power. 
Std Error : it is currently at 21.75 qhich I would say is very very far from 0. This means that model is not a very good fit at all. 
intercept :The p value for my intercept is not significant which would suggest that it does not differ from 0. 
R-squared : So from my understanding, the closer R squared is to one, the better becuase that would be esentially saying that 100% of the variation is explained by the model. My r squared is pretty close to 1 actually so it jsut really looks random to me. 
-So far, I would say my predictor isnt predicting anything. It really just looks random to be and that there is no relationship between testosterone and reproductive output. 
```

Plot the model on the graph. Increase the size of the text so it is comfortably readable at 5 feet. Make sure axis labels are readable and not overlapping with one another. (5 pts)
```{r}
#code here
ggplot(bocas, aes(x = curved_carapace_length, y = t)) + 
     geom_point(size = 0.5) +        ## making the points small to help see the regression line
     scale_x_continuous(limits = c(79, 94))+
     geom_smooth(method = "lm",     ## make a trendline using "lm"
                 color = "navy",    ## make the trendline navy
                 size = 0.5,        ## make the line small to help see the confidence interval for TUTORIAL REASONS
                 fill = "deeppink4") + ## fill for the confidence interval
     labs(x = "curved.carapace.length (cm)", 
          y = "t (pg/ml)", 
          title = "t concentration by carapace length") + 
     annotate("text",                ## geom to annotate with is text annotation
              x = 20, y = 30,         ## coordinates of the label, decided after trying several places..
              label = "R^2 == 0.966", ## label itself, double equals is needed for use with parse=T
              parse=T,               ## makes label actually show as a formula, with squared as superscript!
              color = "firebrick", size = 5)  + ## font color and size 
     theme_bw()

```

Check the normality of the residuals. Do they look OK? Are we violating assumptions? (5 pts)
```{r}
#code here
residuals <- c(-31.481, -15.239,  -4.566,  15.806,  39.697 )
hist(residuals, main = "Residuals Histogram")
 
 # Visual inspection - Q-Q plot
 qqnorm(residuals)
 qqline(residuals)
 
 shapiro.test(residuals)

 #because my residuals vary widly in both the positive and negative, it is an indication that  the model has  relatively large errors in some predictions and I would not trust it. I do not believe they are currently in violation of any assumptions. 
```

Why is normality of residuals important?
```{}
#answer here
One of the biggest reasons why normal residuals are important is because the more normal they are they, it speaks to the validity of the test. You as a scientitis can have trust in your results and test. In addition to also add robustness, a normally distributed residuals allow for easier interpretability. 

```

If you are using surveys_complete: Is there interspecific variation in the linear model? Hint: look at our prior work with facet plots. (15 pts)

If you are not using surveys_complete: Do you think there are groupings within your data that may have a separate linear model? Try grouping the data by that variable and redoing the lm. If this would not make sense for your data, you may also attempt to do multiple predictor variables. (15 pts)
```{r}
#code here
model_fit <- lm(t ~ curved_carapace_length, data = bocas)
summary(model_fit)

#I wanted to see how and if the size of the turtle might affect the concentration of testosterone. It doesnt seem to. 
```

#Part 2
In this portion, you are free to use your own data if you have a categorical predictor variable and a response variable. 

First, plot the data grouped by sex (5 pts)
```{r}
# plot code here
surveys %>% 
  na.omit(sex)
  ggplot(surveys, aes(x = sex, y = hindfoot_length, color=sex)) + geom_jitter() 

```

Try an ANOVA of this data (5 pt)
```{r}
# ANOVA code here
aov(model_fit) -> anova_model_fit
summary(anova_model_fit)

```

How about a linear model? What information does this give you that an ANOVA can’t? (5 pts)
```{r}
#Code here
model_fit <- lm(hindfoot_length ~ sex, data = surveys)

## view output with summary(). 
summary(model_fit)

```

```{}
#Answer here

Not only can a linear model provide a quantitative relationship between two variables but it also allows one to potentially predict for future data points. Linear models are also more versitile than anovas becuase they can handle both continuous and categorical independent variables while also controling for the influence of confounding variables within an experiment or data set. 
```

Plot the lm with the data, with points colored by sex. (10 pts)
```{r}
#Plot code here

ggplot(surveys, aes(x = weight, y = hindfoot_length, color = sex)) + 
     geom_point(size = 0.5) +        ## making the points small to help see the regression line
     geom_smooth(method = "lm",     ## make a trendline using "lm"
                 color = "navy",    ## make the trendline navy
                 size = 0.5,        ## make the line small to help see the confidence interval for 
                 fill = "deeppink4") + ## fill for the confidence interval
     labs(x = "weight",
       y = "hindfoot length (mm)",
          title = "weight by height") + 
     annotate("text",                ## geom to annotate with is text annotation
              x = 25, y = 70,         ## coordinates of the label, decided after trying several places..
              label = "R^2 == 0.002275", ## label itself, double equals is needed for use with parse=T
              parse=T,               ## makes label actually show as a formula, with squared as superscript!
              color = "firebrick", size = 5)  + ## font color and size 
     theme_bw()


```

Choose any model we’ve looked at so far, but use two predictor variables. Perform an LM, plot the results, and state if this changes your interpretation of the relationship between variables (10 pts)
```{r}
# LM Code Here 
model_fit <- lm(weight ~ genus, data = surveys)

## view output with summary(). 
summary(model_fit)


```

```{r}
# Plot Code Here 
ggplot(surveys, aes(x = weight, y = genus, color = weight)) + 
  geom_point(size = 2.5) + # i like the plot with bigger points 
  labs(x = "weight", 
       y = "genus",
       color = "hindfoot_length") +
  scale_color_distiller(palette = "Reds") +
  annotate("text", x = 200, y = 5, label = "R^2 == 0.6262", parse=T, size=5) + 
  theme(legend.position = "bottom") # again my personal preference

```

```{}
# Text answer here
I dont think it changed the relationship. Its still not significant.


```

#Part 3
Add and commit this document (5 pts)
```{}
#Commands here
I went to the "git" icon in the right top side of my R panal and highlighted my document and then clicked commit. After that, I was bale to add my comments and commit it to githun. 
```

Push your changes to github (10 pts)
```{}
I tried to puch my document but there was an issue authenticsting my account. But what I planne dto do was back tot eh git section, select my project_2 document and then selct puch which would ultimatly lead me to my github directory
```

